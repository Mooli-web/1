{% extends "base.html" %}
{% load static %}
{% load jalali_tags %}

{% block title %}وبلاگ و مقالات{% endblock %}

{% block content %}
<div class="container py-5">
    <div class="text-center mb-5">
        <h1 class="display-4 fw-bold text-dark">آخرین مقالات و اخبار</h1>
        <p class="lead text-muted">دانش خود را در زمینه زیبایی و سلامت پوست و مو افزایش دهید.</p>
    </div>

    <div class="row g-4">
        {% for post in posts %}
        <div class="col-md-6 col-lg-4">
            <div class="card h-100 blog-card shadow-sm border-0 rounded-3 overflow-hidden">
                <a href="{{ post.get_absolute_url }}" class="d-block position-relative">
                    {% if post.image %}
                        <img src="{{ post.image.url }}" class="card-img-top" alt="{{ post.title }}" style="height: 250px; object-fit: cover;">
                    {% else %}
                        {# تصویر پیش‌فرض در صورت نبود عکس #}
                        <img src="{% static 'images/blog-placeholder.jpg' %}" class="card-img-top" alt="تصویر مقاله" style="height: 250px; object-fit: cover; opacity: 0.6;">
                    {% endif %}
                    <div class="position-absolute top-0 end-0 bg-white px-3 py-1 m-2 rounded-pill shadow-sm small text-muted">
                        {{ post.created_at|to_jalali:'%Y/%m/%d' }}
                    </div>
                </a>
                
                <div class="card-body d-flex flex-column p-4">
                    <div class="mb-2">
                        <span class="badge bg-light text-dark border">{{ post.category.name|default:"عمومی" }}</span>
                    </div>
                    
                    <h5 class="card-title fw-bold mb-3">
                        <a href="{{ post.get_absolute_url }}" class="text-dark text-decoration-none stretched-link">
                            {{ post.title|truncatechars:60 }}
                        </a>
                    </h5>
                    
                    <p class="card-text text-muted flex-grow-1" style="font-size: 0.95rem; line-height: 1.8;">
                        {{ post.content|striptags|truncatewords:20 }}
                    </p>
                    
                    <div class="d-flex justify-content-between align-items-center mt-4 pt-3 border-top">
                        <div class="text-muted small">
                            <i class="bi bi-eye me-1"></i> {{ post.view_count }}
                            <span class="mx-2">|</span>
                            <i class="bi bi-heart-fill text-danger me-1"></i> {{ post.total_likes }}
                        </div>
                        <span class="text-primary small fw-bold">ادامه مطلب <i class="bi bi-arrow-left ms-1"></i></span>
                    </div>
                </div>
            </div>
        </div>
        {% empty %}
        <div class="col-12 text-center py-5">
            <div class="alert alert-light border rounded-3 d-inline-block px-5 py-4">
                <i class="bi bi-journal-x display-4 text-muted d-block mb-3"></i>
                <p class="lead text-muted mb-0">هنوز مقاله‌ای منتشر نشده است.</p>
            </div>
        </div>
        {% endfor %}
    </div>
    
    {# اگر صفحه‌بندی (Pagination) دارید، کد آن اینجا قرار می‌گیرد #}
</div>
{% endblock %}